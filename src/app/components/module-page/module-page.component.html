<div class="flex flex-row h-screen bg-background font-nunito">
  <!-- Sidebar -->
   <aside class="w-80 flex-shrink-0 bg-primary border-r border-primary-variant flex flex-col overflow-hidden">
    <!-- Module Header -->
    <div class="p-6 border-b border-primary-variant">
      <span class="text-xs text-gray-400 font-medium uppercase">{{ getModuleNumber() }}</span>
      <h3 class="text-body font-semibold text-white mb-4 mt-1">{{ moduleName }}</h3>
      
      <!-- Progress Info -->
      <div class="flex flex-col gap-2">
        <div class="h-2 bg-primary-variant rounded-full overflow-hidden">
          <div 
            class="h-full bg-gradient-to-r from-secondary to-secondary transition-all duration-300"
            [style.width.%]="getProgressPercentage()">
          </div>
        </div>
        <span class="text-s text-gray-300">
          {{ getCompletedCount() }} / {{ lessons.length }} completed
        </span>
      </div>
    </div>

    <!-- Lessons List -->
    <nav class="flex-1 overflow-y-auto p-2">
      <button 
        *ngFor="let lesson of lessons; let i = index"
        class="w-full flex items-center gap-3 p-3 mb-1 rounded-lg border transition-all duration-200"
        [class.bg-secondary]="selectedLesson?.id === lesson.id"
        [class.bg-opacity-20]="selectedLesson?.id === lesson.id"
        [class.border-secondary]="selectedLesson?.id === lesson.id"
        [class.border-primary-variant]="selectedLesson?.id !== lesson.id"
        [class.hover:bg-primary-variant]="selectedLesson?.id !== lesson.id"
        [class.hover:border-secondary]="selectedLesson?.id !== lesson.id"
        [class.opacity-80]="lesson.completed"
        (click)="selectLesson(lesson)">
        
        <!-- Lesson Number -->
        <span 
          class="flex items-center justify-center w-8 h-8 rounded-full text-sm font-semibold flex-shrink-0"
          [class.bg-secondary]="selectedLesson?.id === lesson.id"
          [class.text-primary]="selectedLesson?.id === lesson.id"
          [class.bg-primary-variant]="selectedLesson?.id !== lesson.id"
          [class.text-gray-300]="selectedLesson?.id !== lesson.id">
          {{ i + 1 }}
        </span>
        
        <!-- Lesson Info -->
        <div class="flex-1 flex flex-col gap-1 text-left">
          <span class="text-s font-medium text-white">{{ lesson.title }}</span>
          <span class="text-xs text-gray-400">
            {{ lesson.type === 'video' ? 'â–¶ Video' : 'ðŸ“„ PDF' }}
          </span>
        </div>
        
        <!-- Completed Check -->
        <span 
          *ngIf="lesson.completed" 
          class="flex items-center justify-center w-6 h-6 bg-secondary text-primary rounded-full text-sm flex-shrink-0">
          âœ“
        </span>
      </button>
    </nav>

    <div class="p-4 border-t border-primary-variant">
      <button 
        class="w-full px-4 py-3 mb-3 rounded-md text-body font-medium transition-all duration-200 bg-primary text-white border-secondary border-2 hover:bg-secondary hover:bg-opacity-20 hover:shadow-lg disabled:opacity-50 disabled:cursor-not-allowed"
        (click)="goToQuiz()"
        >
        Take the Quiz
      </button>
       <button 
        class="w-full px-4 py-3 rounded-md text-body font-medium transition-all duration-200 bg-secondary text-primary hover:opacity-90 hover:shadow-lg disabled:opacity-50 disabled:cursor-not-allowed"
        (click)="goToNextModule()"
        
        >
        Next Module â†’
      </button>
    </div>
  </aside>

  <!-- Content Area -->
  <main class="flex-1 min-w-0 flex flex-col overflow-hidden">
    <div *ngIf="selectedLesson" class="flex-1 flex flex-col bg-white m-4 rounded-lg shadow-md overflow-hidden">
      <!-- Content Title -->
      <div class="flex justify-between items-center p-6 border-b border-gray-200">
        <h1 class="text-h2 font-semibold text-primary">{{ selectedLesson.title }}</h1>
      </div>

      <!-- Content -->
      <div class="flex-1 p-4 flex justify-center items-center overflow-auto">
        <!-- Video Player -->
        <iframe 
          *ngIf="selectedLesson.type === 'video'"
          [src]="getSafeUrl(selectedLesson.url)"
          class="w-full h-full rounded"
          frameborder="0"
          allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
          allowfullscreen>
        </iframe>

        <!-- PDF Viewer -->
        <iframe 
          *ngIf="selectedLesson.type === 'pdf'"
          [src]="getSafeUrl(selectedLesson.url)"
          class="w-full h-full rounded"
          frameborder="0">
        </iframe>
      </div>

      <!-- Lesson complete button -->
      <div class="p-6 border-t border-gray-200 bg-secondary bg-opacity-20">
        <button 
          class="w-full px-6 py-3 rounded-md text-body font-medium transition-all duration-200"
          [class.bg-primary]="!selectedLesson.completed"
          [class.hover:bg-primary-variant]="!selectedLesson.completed"
          [class.hover:shadow-lg]="!selectedLesson.completed"
          [class.bg-gray-200]="selectedLesson.completed"
          [class.text-white]="!selectedLesson.completed"
          [class.text-gray-500]="selectedLesson.completed"
          [class.cursor-not-allowed]="selectedLesson.completed"
          (click)="markAsCompleted()"
          [disabled]="selectedLesson.completed">
          {{ selectedLesson.completed ? 'âœ“ Completed' : 'Mark as Completed' }}
        </button>
      </div>
    </div>

    <!-- No Lesson Selected -->
    <div *ngIf="!selectedLesson" class="flex-1 flex items-center justify-center text-gray-400 text-h3">
      <p>Select a lesson to begin</p>
    </div>
  </main>
</div>